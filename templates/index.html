<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>FragDropDetector</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="stylesheet" href="/static/css/design-system.css?v=42">
    <link rel="stylesheet" href="/static/css/base.css?v=42">
    <link rel="stylesheet" href="/static/css/theme.css?v=42">
    <link rel="stylesheet" href="/static/css/toast.css?v=42">
    <link rel="stylesheet" href="/static/css/dashboard.css?v=42">
    <link rel="stylesheet" href="/static/css/activity.css?v=42">
    <link rel="stylesheet" href="/static/css/configuration.css?v=43">
    <link rel="stylesheet" href="/static/css/inventory.css?v=42">
</head>
<body>
    <div class="app-container">
        <header class="top-bar">
            <h1 class="app-title">FragDropDetector</h1>
        </header>

        <nav class="sidebar">
            <div class="nav-header">
                <h1>FragDropDetector</h1>
                <p>Monitoring Dashboard</p>
            </div>

            <div class="nav-menu">
                <a href="#dashboard" class="nav-item active" data-page="dashboard">
                    <span class="nav-icon icon-dashboard"></span>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="#activity" class="nav-item" data-page="activity">
                    <span class="nav-icon icon-activity"></span>
                    <span class="nav-text">Activity</span>
                </a>
                <a href="#inventory" class="nav-item" data-page="inventory">
                    <span class="nav-icon icon-inventory"></span>
                    <span class="nav-text">Inventory</span>
                </a>
                <a href="#configuration" class="nav-item" data-page="configuration">
                    <span class="nav-icon icon-settings"></span>
                    <span class="nav-text">Configuration</span>
                </a>
            </div>

            <div class="nav-footer">
                <div class="status-indicator">
                    <div class="status-dot active" id="system-status"></div>
                    <span class="status-text">System Active</span>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <div id="alert" class="alert"></div>
            <div id="toast-container" class="toast-container"></div>

            <!-- Dashboard Page -->
            <div class="page-content dashboard-page" id="dashboard-content">
                <div class="page-header">
                    <h1 class="page-title">System Dashboard</h1>
                    <p class="page-subtitle">Real-time monitoring overview and system status</p>
                </div>

                <!-- Status Overview -->
                <div class="status-overview grid grid-responsive-4">
                    <div class="status-card card clickable" id="recent-activity-card" onclick="navigateToPage('activity')">
                        <div class="status-card-header">
                            <div class="status-card-title">Recent Activity</div>
                        </div>
                        <div class="status-value" id="recent-activity-text">Loading...</div>
                        <div class="status-label" id="recent-activity-subtitle">--</div>
                    </div>

                    <div class="status-card card clickable" id="reddit-monitor-card" onclick="navigateToConfigTab('reddit')">
                        <div class="status-card-header">
                            <div class="card-badge" id="drops-badge">0</div>
                            <div class="status-card-title">Reddit Monitor</div>
                        </div>
                        <div class="status-value" id="reddit-window-status">Loading...</div>
                        <div class="status-label" id="reddit-window-subtitle">--</div>
                    </div>

                    <div class="status-card card clickable" id="stock-monitor-card" onclick="navigateToPage('inventory')">
                        <div class="status-card-header">
                            <div class="card-badge" id="fragrances-badge">0</div>
                            <div class="status-card-title">Stock Monitor</div>
                        </div>
                        <div class="status-value" id="stock-window-status">Loading...</div>
                        <div class="status-label" id="stock-window-subtitle">--</div>
                    </div>

                    <div class="status-card card clickable" id="watchlist-alerts-card" onclick="navigateToInventoryWatchlist()">
                        <div class="status-card-header">
                            <div class="card-badge" id="stock-changes-badge">0</div>
                            <div class="status-card-title">Watchlist Alerts</div>
                        </div>
                        <div class="status-value" id="watchlist-alert-count">0</div>
                        <div class="status-label" id="watchlist-alert-subtitle">items need attention</div>
                    </div>
                </div>

                <!-- Watchlist Widget and System Health -->
                <div class="grid grid-responsive-3">
                    <div class="card watchlist-widget">
                        <div class="card-header">
                            <h2 class="card-title">Watchlist</h2>
                            <p class="card-subtitle">Products you're tracking</p>
                        </div>

                        <div class="watchlist-summary">
                            <div class="watchlist-stat">
                                <div class="watchlist-stat-value" id="watchlist-total">0</div>
                                <div class="watchlist-stat-label">Total Items</div>
                            </div>
                            <div class="watchlist-stat">
                                <div class="watchlist-stat-value" id="watchlist-in-stock">0</div>
                                <div class="watchlist-stat-label">In Stock</div>
                            </div>
                        </div>

                        <div class="watchlist-items" id="watchlist-items">
                            <!-- Items will be populated by JavaScript -->
                        </div>

                        <a class="watchlist-view-all" onclick="navigateToPage('inventory'); InventoryManager.watchlistOnly = true;">
                            View All Watchlist Items
                        </a>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">System Health</h2>
                            <p class="card-subtitle">Current system status and services</p>
                        </div>

                        <div class="health-grid">
                            <div class="health-item">
                                <div class="health-indicator healthy" id="reddit-health"></div>
                                <div class="health-info">
                                    <div class="health-name">Reddit API</div>
                                    <div class="health-status" id="reddit-status">Connected and monitoring</div>
                                </div>
                            </div>

                            <div class="health-item">
                                <div class="health-indicator healthy" id="database-health"></div>
                                <div class="health-info">
                                    <div class="health-name">Database</div>
                                    <div class="health-status" id="database-status">SQLite operational</div>
                                </div>
                            </div>

                            <div class="health-item">
                                <div class="health-indicator warning" id="notifications-health"></div>
                                <div class="health-info">
                                    <div class="health-name">Notifications</div>
                                    <div class="health-status" id="notifications-status">2 services configured</div>
                                </div>
                            </div>

                            <div class="health-item">
                                <div class="health-indicator healthy" id="monitoring-health"></div>
                                <div class="health-info">
                                    <div class="health-name">Stock Monitor</div>
                                    <div class="health-status" id="monitoring-status">Active monitoring</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Notification Services</h2>
                            <p class="card-subtitle">Active notification channels</p>
                        </div>

                        <div class="notification-services">
                            <div class="service-item" id="pushover-service">
                                <div class="service-icon">📱</div>
                                <div class="service-info">
                                    <div class="service-name">Pushover</div>
                                    <div class="service-status active">iOS notifications active</div>
                                </div>
                                <button class="test-btn" onclick="testService('pushover')">Test</button>
                            </div>

                            <div class="service-item" id="discord-service">
                                <div class="service-icon">💬</div>
                                <div class="service-info">
                                    <div class="service-name">Discord</div>
                                    <div class="service-status active">Webhook configured</div>
                                </div>
                                <button class="test-btn" onclick="testService('discord')">Test</button>
                            </div>

                            <div class="service-item" id="email-service">
                                <div class="service-icon">✉️</div>
                                <div class="service-info">
                                    <div class="service-name">Email</div>
                                    <div class="service-status disabled">Not configured</div>
                                </div>
                                <button class="test-btn" disabled onclick="testService('email')">Test</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Quick Actions</h2>
                        <p class="card-subtitle">Common tasks and controls</p>
                    </div>

                    <div class="quick-actions">
                        <button class="btn primary" onclick="refreshStatus()">
                            <span class="btn-icon">REFRESH</span>
                            Refresh Status
                        </button>

                        <button class="btn secondary" onclick="testAllNotifications()">
                            <span class="btn-icon">TEST</span>
                            Test All Notifications
                        </button>

                        <button class="btn secondary" onclick="navigateToPage('configuration')">
                            <span class="btn-icon">SETTINGS</span>
                            Open Settings
                        </button>

                        <button class="btn secondary" onclick="navigateToPage('inventory')">
                            <span class="btn-icon">VIEW</span>
                            View Inventory
                        </button>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Recent Activity</h2>
                        <p class="card-subtitle">Latest drops and stock changes</p>
                    </div>

                    <div class="recent-activity">
                        <div class="activity-list" id="recent-activity-list">
                            <div class="activity-placeholder">
                                Loading recent activity...
                            </div>
                        </div>

                        <div class="activity-footer">
                            <button class="view-all-btn" onclick="navigateToPage('inventory')">
                                View All Products →
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Activity Page -->
            <div class="page-content activity-page hidden" id="activity-content">
                <div class="page-header">
                    <h1 class="page-title">Recent Activity</h1>
                    <p class="page-subtitle">Timeline of drops and stock changes</p>
                </div>

                <!-- Filter Tabs -->
                <div class="activity-filters">
                    <button class="filter-tab active" data-filter="all">All</button>
                    <button class="filter-tab" data-filter="drops">Drops</button>
                    <button class="filter-tab" data-filter="stock">Stock Changes</button>
                </div>

                <!-- Activity Timeline -->
                <div id="activity-timeline" class="activity-timeline">
                    <div class="loading-placeholder">
                        <div class="loading-spinner"></div>
                        <p>Loading activity...</p>
                    </div>
                </div>

                <!-- Load More -->
                <div class="activity-load-more">
                    <button id="load-more-activity" class="btn btn-secondary">Load More</button>
                </div>
            </div>

            <!-- Inventory Page -->
            <div class="page-content inventory-page hidden" id="inventory-content">
                <div class="page-header">
                    <h1 class="page-title">Fragrance Inventory</h1>
                    <p class="page-subtitle">Browse and manage all tracked fragrances</p>
                </div>

                <!-- Search and Filters Bar -->
                <div class="inventory-controls">
                    <div class="controls-row">
                        <div class="search-container" style="display: flex; gap: var(--space-3);">
                            <input type="text" id="inventory-search" class="search-input" placeholder="Search fragrances..." style="flex: 1;">
                            <button id="watchlist-toggle" class="watchlist-toggle">
                                <span>Watchlist Only</span>
                            </button>
                            <button id="density-toggle" class="density-toggle" title="Toggle view density">
                                <span class="density-icon">▦</span>
                            </button>
                        </div>

                        <div class="filter-container">
                            <select id="stock-filter" class="filter-select">
                                <option value="">All Products</option>
                                <option value="true">In Stock</option>
                                <option value="false">Out of Stock</option>
                            </select>

                            <div class="multi-select-filter" id="gender-filter-container">
                                <button class="filter-select multi-select-button" id="gender-filter-button">
                                    <span id="gender-filter-label">All Genders</span>
                                    <span class="dropdown-arrow">▼</span>
                                </button>
                                <div class="multi-select-dropdown" id="gender-filter-dropdown">
                                    <label class="multi-select-option">
                                        <input type="checkbox" value="male" class="gender-checkbox">
                                        <span>Male</span>
                                    </label>
                                    <label class="multi-select-option">
                                        <input type="checkbox" value="female" class="gender-checkbox">
                                        <span>Female</span>
                                    </label>
                                    <label class="multi-select-option">
                                        <input type="checkbox" value="unisex" class="gender-checkbox">
                                        <span>Unisex</span>
                                    </label>
                                    <div class="multi-select-actions">
                                        <button class="multi-select-clear" id="gender-filter-clear">Clear</button>
                                    </div>
                                </div>
                            </div>

                            <select id="sort-select" class="filter-select">
                                <option value="name">Sort by Name</option>
                                <option value="price">Sort by Price</option>
                                <option value="in_stock">Sort by Availability</option>
                                <option value="parfumo_score">Sort by Rating</option>
                                <option value="parfumo_votes">Sort by Popularity</option>
                            </select>
                            <button id="sort-direction-toggle" class="sort-direction-btn" title="Toggle sort direction">
                                <span class="sort-arrow">↑</span>
                            </button>
                        </div>
                    </div>

                    <div class="stats-row">
                        <span class="stat-item">Total: <strong id="total-count">0</strong></span>
                        <span class="stat-item">In Stock: <strong id="in-stock-count">0</strong></span>
                        <span class="stat-item">Out of Stock: <strong id="out-stock-count">0</strong></span>
                        <span class="stat-item">Watchlist: <strong id="watchlist-count">0</strong></span>
                    </div>
                </div>

                <!-- Bulk Actions Bar -->
                <div id="bulk-actions" class="bulk-actions">
                    <span class="bulk-actions-count">
                        <span id="selected-count">0</span> items selected
                    </span>
                    <div class="bulk-actions-buttons">
                        <button class="bulk-action-btn" onclick="InventoryManager.selectAll()">Select All</button>
                        <button class="bulk-action-btn" onclick="InventoryManager.clearSelection()">Clear</button>
                        <button class="bulk-action-btn" onclick="InventoryManager.bulkAddToWatchlist()">Add to Watchlist</button>
                        <button class="bulk-action-btn" onclick="InventoryManager.bulkRemoveFromWatchlist()">Remove from Watchlist</button>
                    </div>
                </div>

                <!-- Inventory Grid -->
                <div class="inventory-grid-container">
                    <div id="inventory-grid" class="inventory-grid">
                        <!-- Grid items will be dynamically added here -->
                    </div>

                    <!-- Loading indicator -->
                    <div id="inventory-loading" class="loading-indicator">
                        <div class="spinner"></div>
                        <p>Loading inventory...</p>
                    </div>

                    <!-- No results message -->
                    <div id="no-results" class="no-results hidden">
                        <p>No fragrances match your search criteria</p>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="pagination-container">
                    <button id="prev-page" class="pagination-btn" disabled>Previous</button>
                    <span class="pagination-info">
                        Page <span id="current-page">1</span> of <span id="total-pages">1</span>
                    </span>
                    <button id="next-page" class="pagination-btn">Next</button>
                </div>

                <!-- Floating Action Button for Mobile -->
                <button class="inventory-fab" id="inventory-fab" title="Quick Filters">
                    ⚡
                </button>
            </div>

            <!-- Configuration Page -->
            <div class="page-content configuration-page hidden" id="configuration-content">
                <div class="page-header">
                    <h1 class="page-title">Configuration</h1>
                    <p class="page-subtitle">Configure monitoring settings and notification services</p>
                </div>

                <!-- Configuration Tabs -->
                <div class="config-tabs">
                    <div class="tab-nav">
                        <button class="tab-btn active" data-tab="reddit">Reddit Monitor</button>
                        <button class="tab-btn" data-tab="website">Website Monitor</button>
                        <button class="tab-btn" data-tab="parfumo">Parfumo</button>
                        <button class="tab-btn" data-tab="detection">Detection Rules</button>
                        <button class="tab-btn" data-tab="notifications">Notifications</button>
                        <button class="tab-btn" data-tab="logging">System & Logs</button>
                    </div>

                    <!-- Reddit Monitor -->
                    <div class="tab-content active" id="reddit-tab">
                        <!-- Authentication Status Banner -->
                        <div class="auth-status-banner warning" id="reddit-auth-banner" style="display: none;">
                            <div class="banner-icon">⚠️</div>
                            <div class="banner-content">
                                <h3>Reddit Authentication Required</h3>
                                <p>User authentication is required to monitor r/MontagneParfums. Without it, you'll miss member-only posts and notification links may not work.</p>
                                <div class="banner-actions">
                                    <button class="btn primary" onclick="showAuthSetupModal()">Setup Authentication</button>
                                </div>
                            </div>
                        </div>

                        <div class="auth-status-banner success" id="reddit-auth-success" style="display: none;">
                            <div class="banner-icon">✅</div>
                            <div class="banner-content">
                                <h3>Reddit Authentication Active</h3>
                                <p id="auth-user-info">Authenticated as u/username</p>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Reddit Monitoring Configuration</h2>
                                <p class="card-subtitle">Monitor r/MontagneParfums for drop announcements</p>
                            </div>

                            <form id="reddit-form">
                                <h3 class="section-title">API Credentials</h3>
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Client ID</label>
                                        <input type="text" id="reddit-client-id" placeholder="Your Reddit App Client ID" required>
                                        <small>Get this from https://www.reddit.com/prefs/apps</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Client Secret</label>
                                        <input type="password" id="reddit-client-secret" placeholder="Your Reddit App Client Secret" required>
                                        <small>Keep this secret and secure</small>
                                    </div>
                                </div>

                                <h3 class="section-title">Monitoring Settings</h3>
                                <div class="form-group">
                                    <label>Check Every</label>
                                    <select id="reddit-interval" class="form-input">
                                        <option value="60">1 minute</option>
                                        <option value="120">2 minutes</option>
                                        <option value="300" selected>5 minutes</option>
                                        <option value="600">10 minutes</option>
                                        <option value="900">15 minutes</option>
                                        <option value="1800">30 minutes</option>
                                    </select>
                                    <small>How frequently to check for new Reddit posts</small>
                                </div>

                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="window-enabled">
                                        <span class="toggle-slider"></span>
                                        Enable Time Restrictions
                                    </label>
                                    <small>Only check Reddit during specific days/times (leave off for 24/7 monitoring)</small>
                                </div>

                                <div class="window-config" id="reddit-window-config" style="display: none;">
                                    <div class="form-group">
                                        <label>Timezone</label>
                                        <select id="window-timezone" class="form-input">
                                            <option value="America/New_York">Eastern Time</option>
                                            <option value="America/Chicago">Central Time</option>
                                            <option value="America/Denver">Mountain Time</option>
                                            <option value="America/Los_Angeles">Pacific Time</option>
                                            <option value="UTC">UTC</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Days to Monitor</label>
                                        <div class="days-grid">
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="day-0" value="0">
                                                <span class="checkbox-custom"></span>
                                                Monday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="day-1" value="1">
                                                <span class="checkbox-custom"></span>
                                                Tuesday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="day-2" value="2">
                                                <span class="checkbox-custom"></span>
                                                Wednesday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="day-3" value="3">
                                                <span class="checkbox-custom"></span>
                                                Thursday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="day-4" value="4">
                                                <span class="checkbox-custom"></span>
                                                Friday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="day-5" value="5">
                                                <span class="checkbox-custom"></span>
                                                Saturday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="day-6" value="6">
                                                <span class="checkbox-custom"></span>
                                                Sunday
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label>Active Hours</label>
                                        <div class="time-range">
                                            <input type="time" id="window-start-time" class="form-input" value="12:00">
                                            <span class="time-separator">to</span>
                                            <input type="time" id="window-end-time" class="form-input" value="17:00">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="button" class="btn secondary" onclick="testRedditConnection()">Test Connection</button>
                                    <button type="submit" class="btn primary">Save Reddit Settings</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Notifications Configuration -->
                    <div class="tab-content" id="notifications-tab">
                        <div class="grid grid-2">
                            <!-- Pushover -->
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Pushover (iOS/Android)</h2>
                                    <p class="card-subtitle">Real-time push notifications</p>
                                </div>

                                <div class="notification-config">
                                    <div class="form-group">
                                        <label>App Token</label>
                                        <input type="text" id="pushover-app-token" placeholder="Your Pushover App Token">
                                    </div>

                                    <div class="form-group">
                                        <label>User Key</label>
                                        <input type="text" id="pushover-user-key" placeholder="Your Pushover User Key">
                                    </div>

                                    <div class="service-status" id="pushover-status">
                                        <span class="status-indicator disabled"></span>
                                        <span class="status-text">Not configured</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Discord -->
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Discord Webhook</h2>
                                    <p class="card-subtitle">Discord server notifications</p>
                                </div>

                                <div class="notification-config">
                                    <div class="form-group">
                                        <label>Webhook URL</label>
                                        <input type="text" id="discord-webhook" placeholder="https://discord.com/api/webhooks/...">
                                    </div>

                                    <div class="service-status" id="discord-status">
                                        <span class="status-indicator disabled"></span>
                                        <span class="status-text">Not configured</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="form-actions">
                                <button type="button" class="btn secondary" onclick="testAllNotifications()">Test All Services</button>
                                <button type="button" class="btn primary" onclick="handleNotificationConfigSubmit()">Save Notification Settings</button>
                            </div>
                        </div>
                    </div>

                    <!-- Detection Rules -->
                    <div class="tab-content" id="detection-tab">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Detection Rules</h2>
                                <p class="card-subtitle">Configure keywords and parameters for identifying fragrance drops</p>
                            </div>

                            <form id="detection-form">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Primary Keywords</label>
                                        <textarea id="primary-keywords" rows="6" placeholder="Enter keywords, one per line">drop
dropped
release
available
launch
restock
in stock</textarea>
                                        <small>High-priority keywords that strongly indicate drops</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Secondary Keywords</label>
                                        <textarea id="secondary-keywords" rows="6" placeholder="Enter keywords, one per line">limited
exclusive
sale
batch
decant
split</textarea>
                                        <small>Supporting keywords that provide additional context</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Exclusion Keywords</label>
                                        <textarea id="exclusion-keywords" rows="6" placeholder="Enter keywords to exclude (one per line)">looking for
where to buy
wtb
wts
iso
recommendation
review</textarea>
                                        <small>Keywords that indicate posts to exclude from drop detection</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Trusted Authors</label>
                                        <textarea id="trusted-authors" rows="6" placeholder="Enter Reddit usernames (one per line)">ayybrahamlmaocoln
wide_parsley1799
montagneparfums
mpofficial</textarea>
                                        <small>Posts from these Reddit users get high confidence scores (0.6)</small>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Confidence Threshold</label>
                                    <div class="range-input">
                                        <input type="range" id="confidence-threshold" min="0" max="1" step="0.1" value="0.4">
                                        <span class="range-value" id="confidence-value">0.4</span>
                                    </div>
                                    <small>Minimum confidence score required to trigger notifications (0.0 - 1.0)</small>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn primary">Save Detection Rules</button>
                                </div>
                            </form>
                        </div>
                    </div>


                    <!-- Website Monitor Tab -->
                    <div class="tab-content" id="website-tab">
                        <!-- Monitoring Settings -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Monitoring Settings</h2>
                                <p class="card-subtitle">Configure website inventory tracking and notifications</p>
                            </div>

                            <form id="stock-form">
                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="stock-enabled">
                                        <span class="toggle-slider"></span>
                                        Enable Website Monitoring
                                    </label>
                                    <small>Monitor Montagne Parfums website for inventory changes</small>
                                </div>

                                <div class="notification-types">
                                    <h3>Notification Types</h3>

                                    <label class="checkbox-option">
                                        <input type="checkbox" id="notify-new-products" checked>
                                        <span class="checkbox-custom"></span>
                                        <div class="option-info">
                                            <div class="option-title">New Products</div>
                                            <div class="option-description">Notify when new fragrances are added</div>
                                        </div>
                                    </label>

                                    <label class="checkbox-option">
                                        <input type="checkbox" id="notify-restocked" checked>
                                        <span class="checkbox-custom"></span>
                                        <div class="option-info">
                                            <div class="option-title">Restocked Items</div>
                                            <div class="option-description">Notify when out-of-stock items become available</div>
                                        </div>
                                    </label>

                                    <label class="checkbox-option">
                                        <input type="checkbox" id="notify-price-changes">
                                        <span class="checkbox-custom"></span>
                                        <div class="option-info">
                                            <div class="option-title">Price Changes</div>
                                            <div class="option-description">Notify when prices increase or decrease</div>
                                        </div>
                                    </label>

                                    <label class="checkbox-option">
                                        <input type="checkbox" id="notify-out-of-stock">
                                        <span class="checkbox-custom"></span>
                                        <div class="option-info">
                                            <div class="option-title">Out of Stock</div>
                                            <div class="option-description">Notify when items go out of stock</div>
                                        </div>
                                    </label>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn primary">Save Monitoring Settings</button>
                                </div>
                            </form>
                        </div>

                        <!-- Schedule Settings -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Schedule Settings</h2>
                                <p class="card-subtitle">Configure when and how often to check for inventory changes</p>
                            </div>

                            <form id="stock-schedule-form">
                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="stock-schedule-enabled">
                                        <span class="toggle-slider"></span>
                                        Enable Scheduled Monitoring
                                    </label>
                                    <small>Enable independent website monitoring schedule (separate from Reddit monitoring)</small>
                                </div>

                                <div class="form-group">
                                    <label for="stock-check-interval">Check Interval</label>
                                    <select id="stock-check-interval" class="form-input">
                                        <option value="300">5 minutes</option>
                                        <option value="900">15 minutes</option>
                                        <option value="1800" selected>30 minutes</option>
                                        <option value="3600">1 hour</option>
                                        <option value="7200">2 hours</option>
                                        <option value="14400">4 hours</option>
                                        <option value="21600">6 hours</option>
                                        <option value="43200">12 hours</option>
                                        <option value="86400">24 hours</option>
                                    </select>
                                    <small>How often to check for inventory changes</small>
                                </div>

                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="stock-window-enabled">
                                        <span class="toggle-slider"></span>
                                        Enable Time Restrictions
                                    </label>
                                    <small>Restrict monitoring to specific days/times (leave off to monitor 24/7)</small>
                                </div>

                                <div class="window-config" id="stock-window-config" style="display: none;">
                                    <div class="form-group">
                                        <label for="stock-window-timezone">Timezone</label>
                                        <select id="stock-window-timezone" class="form-input">
                                            <option value="America/New_York">Eastern Time</option>
                                            <option value="America/Chicago">Central Time</option>
                                            <option value="America/Denver">Mountain Time</option>
                                            <option value="America/Los_Angeles">Pacific Time</option>
                                            <option value="UTC">UTC</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Active Days</label>
                                        <div class="days-grid">
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="stock-day-0" value="0">
                                                <span class="checkbox-custom"></span>
                                                Monday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="stock-day-1" value="1">
                                                <span class="checkbox-custom"></span>
                                                Tuesday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="stock-day-2" value="2">
                                                <span class="checkbox-custom"></span>
                                                Wednesday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="stock-day-3" value="3">
                                                <span class="checkbox-custom"></span>
                                                Thursday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="stock-day-4" value="4">
                                                <span class="checkbox-custom"></span>
                                                Friday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="stock-day-5" value="5">
                                                <span class="checkbox-custom"></span>
                                                Saturday
                                            </label>
                                            <label class="checkbox-option compact">
                                                <input type="checkbox" id="stock-day-6" value="6">
                                                <span class="checkbox-custom"></span>
                                                Sunday
                                            </label>
                                        </div>
                                        <small>Leave all unchecked to monitor every day</small>
                                    </div>

                                    <div class="time-range">
                                        <div class="form-group">
                                            <label for="stock-window-start-time">Start Time</label>
                                            <input type="time" id="stock-window-start-time" class="form-input" value="09:00">
                                        </div>
                                        <div class="form-group">
                                            <label for="stock-window-end-time">End Time</label>
                                            <input type="time" id="stock-window-end-time" class="form-input" value="18:00">
                                        </div>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn primary">Save Schedule Settings</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Parfumo Tab -->
                    <div class="tab-content" id="parfumo-tab">
                        <!-- Parfumo Settings -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Parfumo Integration</h2>
                                <p class="card-subtitle">Configure automatic rating updates from Parfumo.com</p>
                            </div>

                            <form id="parfumo-form">
                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="parfumo-enabled" checked>
                                        <span class="toggle-slider"></span>
                                        Enable Parfumo Integration
                                    </label>
                                    <small>Fetch fragrance ratings and information from Parfumo.com</small>
                                </div>

                                <div class="form-group">
                                    <label for="parfumo-update-time">Daily Update Time</label>
                                    <input type="time" id="parfumo-update-time" class="form-input" value="02:00">
                                    <small>Time to run daily update of all fragrance ratings (uses Reddit Monitor timezone)</small>
                                </div>

                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="parfumo-auto-scrape" checked>
                                        <span class="toggle-slider"></span>
                                        Auto-scrape New Products
                                    </label>
                                    <small>Automatically fetch Parfumo data when new products are detected</small>
                                </div>


                                <div class="form-actions">
                                    <button type="submit" class="btn primary">Save Settings</button>
                                </div>
                            </form>
                        </div>

                        <!-- Parfumo Status -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Update Status</h2>
                                <p class="card-subtitle">Current status of Parfumo data synchronization</p>
                            </div>

                            <div class="parfumo-status">
                                <div class="status-grid">
                                    <div class="status-item">
                                        <span class="status-label">Last Update:</span>
                                        <span class="status-value" id="parfumo-last-update">Never</span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">Total Mapped:</span>
                                        <span class="status-value" id="parfumo-total-mapped">0</span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">With Ratings:</span>
                                        <span class="status-value" id="parfumo-with-ratings">0</span>
                                    </div>
                                    <div class="status-item">
                                        <span class="status-label">Not Found:</span>
                                        <span class="status-value" id="parfumo-not-found">0</span>
                                    </div>
                                </div>

                                <div class="update-progress" id="parfumo-progress" style="display: none;">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="parfumo-progress-bar" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="parfumo-progress-text">Updating...</span>
                                </div>

                                <div class="form-actions">
                                    <button type="button" class="btn secondary" id="parfumo-update-btn" onclick="triggerParfumoUpdate()">
                                        Update Now
                                    </button>
                                    <small id="parfumo-update-status"></small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System & Logs Tab -->
                    <div class="tab-content" id="logging-tab">
                        <!-- Current Usage -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Log Usage Statistics</h2>
                                <p class="card-subtitle">Current disk usage and file information</p>
                            </div>
                            <div id="log-usage-stats" class="stats-container">
                                <div class="stat-item">
                                    <label>Total Size:</label>
                                    <span id="total-log-size">0 MB</span>
                                </div>
                                <div class="stat-item">
                                    <label>Logs Directory:</label>
                                    <span id="logs-dir-size">0 MB</span>
                                </div>
                                <div class="stat-item">
                                    <label>Cache Directory:</label>
                                    <span id="cache-dir-size">0 MB</span>
                                </div>
                                <div class="stat-item">
                                    <label>File Count:</label>
                                    <span id="log-file-count">0</span>
                                </div>
                                <div class="stat-item">
                                    <label>Oldest File:</label>
                                    <span id="oldest-log-file">N/A</span>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn" onclick="refreshLogUsage()">Refresh Stats</button>
                                <button type="button" class="btn warning" onclick="manualCleanup()">Run Cleanup Now</button>
                                <button type="button" class="btn primary" onclick="downloadLogs()">Download All Logs</button>
                            </div>
                        </div>

                        <!-- Logging Configuration -->
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Logging Settings</h2>
                                <p class="card-subtitle">Configure log rotation and automatic cleanup</p>
                            </div>

                            <form id="logging-form">
                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="file-logging-enabled">
                                        <span class="toggle-slider"></span>
                                        Enable File Logging
                                    </label>
                                    <small>Log to files in addition to console output</small>
                                </div>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Log Level</label>
                                        <select id="log-level">
                                            <option value="DEBUG">DEBUG</option>
                                            <option value="INFO" selected>INFO</option>
                                            <option value="WARNING">WARNING</option>
                                            <option value="ERROR">ERROR</option>
                                            <option value="CRITICAL">CRITICAL</option>
                                        </select>
                                        <small>Minimum level of messages to log</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Max File Size (MB)</label>
                                        <input type="number" id="max-file-size" min="1" max="100" value="10">
                                        <small>Rotate logs when they reach this size</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Backup Files to Keep</label>
                                        <input type="number" id="backup-count" min="0" max="20" value="5">
                                        <small>Number of rotated log files to keep</small>
                                    </div>
                                </div>

                                <h3 class="section-title">Automatic Cleanup</h3>

                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="auto-cleanup-enabled" checked>
                                        <span class="toggle-slider"></span>
                                        Enable Automatic Cleanup
                                    </label>
                                    <small>Automatically clean up old logs and cache files</small>
                                </div>

                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Max Age (Days)</label>
                                        <input type="number" id="max-age-days" min="1" max="365" value="30">
                                        <small>Delete logs older than this many days</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Max Total Size (MB)</label>
                                        <input type="number" id="max-total-size" min="10" max="1000" value="100">
                                        <small>Delete oldest logs if total size exceeds this</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Cleanup Interval (Hours)</label>
                                        <input type="number" id="cleanup-interval" min="1" max="168" value="24">
                                        <small>Run automatic cleanup every N hours</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Cache Max Age (Days)</label>
                                        <input type="number" id="cache-max-age" min="1" max="30" value="7">
                                        <small>Delete cached files older than this</small>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="compress-old-logs" checked>
                                        <span class="toggle-slider"></span>
                                        Compress Old Logs
                                    </label>
                                    <small>Compress old logs with gzip to save space</small>
                                </div>

                                <div class="form-group">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="clean-cache" checked>
                                        <span class="toggle-slider"></span>
                                        Clean Cache Directory
                                    </label>
                                    <small>Also clean up old cache files during cleanup</small>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn primary">Save Logging Settings</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <!-- Bottom Navigation for Mobile -->
        <nav class="bottom-nav">
            <div class="bottom-nav-container">
                <a href="#dashboard" class="bottom-nav-item active" data-page="dashboard">
                    <div class="bottom-nav-icon icon-dashboard"></div>
                    <span>Dashboard</span>
                </a>
                <a href="#activity" class="bottom-nav-item" data-page="activity">
                    <div class="bottom-nav-icon icon-activity"></div>
                    <span>Activity</span>
                </a>
                <a href="#inventory" class="bottom-nav-item" data-page="inventory">
                    <div class="bottom-nav-icon icon-inventory"></div>
                    <span>Inventory</span>
                </a>
                <a href="#configuration" class="bottom-nav-item" data-page="configuration">
                    <div class="bottom-nav-icon icon-settings"></div>
                    <span>Settings</span>
                </a>
            </div>
        </nav>
    </div>

    <script src="/static/js/dashboard-functions.js?v=23"></script>
    <script src="/static/js/toast.js?v=23"></script>
    <script src="/static/js/theme.js?v=23"></script>
    <!-- API Layer -->
    <script src="/static/js/api/client.js?v=23"></script>
    <script src="/static/js/api/endpoints.js?v=23"></script>
    <script src="/static/js/api/services.js?v=23"></script>
    <!-- State Management -->
    <script src="/static/js/state.js?v=24"></script>
    <!-- Application -->
    <script src="/static/js/router.js?v=23"></script>
    <script src="/static/js/app.js?v=23"></script>
    <!-- Dashboard Modules -->
    <script src="/static/js/dashboard/utils.js?v=25"></script>
    <script src="/static/js/dashboard/display.js?v=25"></script>
    <script src="/static/js/dashboard/health.js?v=25"></script>
    <script src="/static/js/dashboard/status.js?v=25"></script>
    <script src="/static/js/dashboard/data.js?v=25"></script>
    <script src="/static/js/dashboard-main.js?v=25"></script>
    <script src="/static/js/activity.js?v=22"></script>
    <!-- Configuration Modules -->
    <script src="/static/js/config/reddit-config.js?v=22"></script>
    <script src="/static/js/config/notification-config.js?v=22"></script>
    <script src="/static/js/config/detection-config.js?v=22"></script>
    <script src="/static/js/config/stock-config.js?v=22"></script>
    <script src="/static/js/config/logging-config.js?v=22"></script>
    <script src="/static/js/config/parfumo-config.js?v=28"></script>
    <script src="/static/js/configuration.js?v=22"></script>
    <script src="/static/js/inventory.js?v=22"></script>
</body>
</html>
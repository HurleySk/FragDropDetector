<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>FragDropDetector</title>
    <link rel="stylesheet" href="/static/css/base.css?v=3">
    <link rel="stylesheet" href="/static/css/theme.css?v=3">
    <link rel="stylesheet" href="/static/css/toast.css?v=3">
    <link rel="stylesheet" href="/static/css/dashboard.css?v=4">
    <link rel="stylesheet" href="/static/css/configuration.css?v=3">
    <link rel="stylesheet" href="/static/css/inventory.css?v=4">
</head>
<body>
    <div class="app-container">
        <header class="top-bar">
            <button class="mobile-menu-toggle">Menu</button>
            <h1 class="app-title">FragDropDetector</h1>
        </header>

        <nav class="sidebar">
            <div class="nav-header">
                <h1>FragDropDetector</h1>
                <p>Monitoring Dashboard</p>
            </div>

            <div class="nav-menu">
                <a href="#dashboard" class="nav-item active" data-page="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="#inventory" class="nav-item" data-page="inventory">
                    <span class="nav-icon">üß¥</span>
                    <span class="nav-text">Inventory</span>
                </a>
                <a href="#configuration" class="nav-item" data-page="configuration">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span class="nav-text">Configuration</span>
                </a>
            </div>

            <div class="nav-footer">
                <div class="status-indicator">
                    <div class="status-dot active" id="system-status"></div>
                    <span class="status-text">System Active</span>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <div id="alert" class="alert"></div>

            <!-- Dashboard Page -->
            <div class="page-content dashboard-page" id="dashboard-content">
                <div class="page-header">
                    <h1 class="page-title">System Dashboard</h1>
                    <p class="page-subtitle">Real-time monitoring overview and system status</p>
                </div>

                <!-- Status Overview -->
                <div class="status-overview grid grid-responsive-4">
                    <div class="status-card card">
                        <div class="status-card-icon">üéØ</div>
                        <div class="status-value" id="drops-count">0</div>
                        <div class="status-label">Drops Detected</div>
                    </div>

                    <div class="status-card card">
                        <div class="status-card-icon">üß¥</div>
                        <div class="status-value" id="fragrances-count">0</div>
                        <div class="status-label">Fragrances Tracked</div>
                    </div>

                    <div class="status-card card">
                        <div class="status-card-icon">üìà</div>
                        <div class="status-value" id="stock-changes-count">0</div>
                        <div class="status-label">Stock Changes</div>
                    </div>

                    <div class="status-card card">
                        <div class="status-card-icon">‚è∞</div>
                        <div class="status-value" id="next-window">--</div>
                        <div class="status-label">Next Window</div>
                    </div>
                </div>

                <!-- Watchlist Widget and System Health -->
                <div class="grid grid-responsive-3">
                    <div class="card watchlist-widget">
                        <div class="card-header">
                            <h2 class="card-title">Watchlist</h2>
                            <p class="card-subtitle">Products you're tracking</p>
                        </div>

                        <div class="watchlist-summary">
                            <div class="watchlist-stat">
                                <div class="watchlist-stat-value" id="watchlist-total">0</div>
                                <div class="watchlist-stat-label">Total Items</div>
                            </div>
                            <div class="watchlist-stat">
                                <div class="watchlist-stat-value" id="watchlist-in-stock">0</div>
                                <div class="watchlist-stat-label">In Stock</div>
                            </div>
                        </div>

                        <div class="watchlist-items" id="watchlist-items">
                            <!-- Items will be populated by JavaScript -->
                        </div>

                        <a class="watchlist-view-all" onclick="navigateToPage('inventory'); InventoryManager.watchlistOnly = true;">
                            View All Watchlist Items
                        </a>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">System Health</h2>
                            <p class="card-subtitle">Current system status and services</p>
                        </div>

                        <div class="health-grid">
                            <div class="health-item">
                                <div class="health-indicator healthy" id="reddit-health"></div>
                                <div class="health-info">
                                    <div class="health-name">Reddit API</div>
                                    <div class="health-status" id="reddit-status">Connected and monitoring</div>
                                </div>
                            </div>

                            <div class="health-item">
                                <div class="health-indicator healthy" id="database-health"></div>
                                <div class="health-info">
                                    <div class="health-name">Database</div>
                                    <div class="health-status" id="database-status">SQLite operational</div>
                                </div>
                            </div>

                            <div class="health-item">
                                <div class="health-indicator warning" id="notifications-health"></div>
                                <div class="health-info">
                                    <div class="health-name">Notifications</div>
                                    <div class="health-status" id="notifications-status">2 services configured</div>
                                </div>
                            </div>

                            <div class="health-item">
                                <div class="health-indicator healthy" id="monitoring-health"></div>
                                <div class="health-info">
                                    <div class="health-name">Stock Monitor</div>
                                    <div class="health-status" id="monitoring-status">Active monitoring</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Notification Services</h2>
                            <p class="card-subtitle">Active notification channels</p>
                        </div>

                        <div class="notification-services">
                            <div class="service-item" id="pushover-service">
                                <div class="service-icon">üì±</div>
                                <div class="service-info">
                                    <div class="service-name">Pushover</div>
                                    <div class="service-status active">iOS notifications active</div>
                                </div>
                                <button class="test-btn" onclick="testService('pushover')">Test</button>
                            </div>

                            <div class="service-item" id="discord-service">
                                <div class="service-icon">üí¨</div>
                                <div class="service-info">
                                    <div class="service-name">Discord</div>
                                    <div class="service-status active">Webhook configured</div>
                                </div>
                                <button class="test-btn" onclick="testService('discord')">Test</button>
                            </div>

                            <div class="service-item" id="email-service">
                                <div class="service-icon">‚úâÔ∏è</div>
                                <div class="service-info">
                                    <div class="service-name">Email</div>
                                    <div class="service-status disabled">Not configured</div>
                                </div>
                                <button class="test-btn" disabled onclick="testService('email')">Test</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Quick Actions</h2>
                        <p class="card-subtitle">Common tasks and controls</p>
                    </div>

                    <div class="quick-actions">
                        <button class="action-btn primary" onclick="refreshStatus()">
                            <span class="btn-icon">REFRESH</span>
                            Refresh Status
                        </button>

                        <button class="action-btn secondary" onclick="testAllNotifications()">
                            <span class="btn-icon">TEST</span>
                            Test All Notifications
                        </button>

                        <button class="action-btn secondary" onclick="navigateToPage('configuration')">
                            <span class="btn-icon">SETTINGS</span>
                            Open Settings
                        </button>

                        <button class="action-btn secondary" onclick="navigateToPage('inventory')">
                            <span class="btn-icon">VIEW</span>
                            View Inventory
                        </button>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Recent Activity</h2>
                        <p class="card-subtitle">Latest drops and stock changes</p>
                    </div>

                    <div class="recent-activity">
                        <div class="activity-list" id="recent-activity-list">
                            <div class="activity-placeholder">
                                Loading recent activity...
                            </div>
                        </div>

                        <div class="activity-footer">
                            <button class="view-all-btn" onclick="navigateToPage('inventory')">
                                View All Products ‚Üí
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inventory Page -->
            <div class="page-content inventory-page hidden" id="inventory-content">
                <div class="page-header">
                    <h1 class="page-title">Fragrance Inventory</h1>
                    <p class="page-subtitle">Browse and manage all tracked fragrances</p>
                </div>

                <!-- Search and Filters Bar -->
                <div class="inventory-controls">
                    <div class="controls-row">
                        <div class="search-container" style="display: flex; gap: var(--space-3);">
                            <input type="text" id="inventory-search" class="search-input" placeholder="Search fragrances..." style="flex: 1;">
                            <button id="watchlist-toggle" class="watchlist-toggle">
                                <span>Watchlist Only</span>
                            </button>
                        </div>

                        <div class="filter-container">
                            <select id="stock-filter" class="filter-select">
                                <option value="">All Products</option>
                                <option value="true">In Stock</option>
                                <option value="false">Out of Stock</option>
                            </select>


                            <select id="sort-select" class="filter-select">
                                <option value="name">Sort by Name</option>
                                <option value="price">Sort by Price</option>
                                <option value="in_stock">Sort by Stock</option>
                            </select>
                        </div>
                    </div>

                    <div class="stats-row">
                        <span class="stat-item">Total: <strong id="total-count">0</strong></span>
                        <span class="stat-item">In Stock: <strong id="in-stock-count">0</strong></span>
                        <span class="stat-item">Out of Stock: <strong id="out-stock-count">0</strong></span>
                        <span class="stat-item">Watchlist: <strong id="watchlist-count">0</strong></span>
                    </div>
                </div>

                <!-- Bulk Actions Bar -->
                <div id="bulk-actions" class="bulk-actions">
                    <span class="bulk-actions-count">
                        <span id="selected-count">0</span> items selected
                    </span>
                    <div class="bulk-actions-buttons">
                        <button class="bulk-action-btn" onclick="InventoryManager.selectAll()">Select All</button>
                        <button class="bulk-action-btn" onclick="InventoryManager.clearSelection()">Clear</button>
                        <button class="bulk-action-btn" onclick="InventoryManager.bulkAddToWatchlist()">Add to Watchlist</button>
                        <button class="bulk-action-btn" onclick="InventoryManager.bulkRemoveFromWatchlist()">Remove from Watchlist</button>
                    </div>
                </div>

                <!-- Inventory Grid -->
                <div class="inventory-grid-container">
                    <div id="inventory-grid" class="inventory-grid">
                        <!-- Grid items will be dynamically added here -->
                    </div>

                    <!-- Loading indicator -->
                    <div id="inventory-loading" class="loading-indicator">
                        <div class="spinner"></div>
                        <p>Loading inventory...</p>
                    </div>

                    <!-- No results message -->
                    <div id="no-results" class="no-results hidden">
                        <p>No fragrances match your search criteria</p>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="pagination-container">
                    <button id="prev-page" class="pagination-btn" disabled>Previous</button>
                    <span class="pagination-info">
                        Page <span id="current-page">1</span> of <span id="total-pages">1</span>
                    </span>
                    <button id="next-page" class="pagination-btn">Next</button>
                </div>
            </div>

            <!-- Configuration Page -->
            <div class="page-content configuration-page hidden" id="configuration-content">
                <div class="page-header">
                    <h1 class="page-title">Configuration</h1>
                    <p class="page-subtitle">Configure monitoring settings and notification services</p>
                </div>

                <!-- Configuration Tabs -->
                <div class="config-tabs">
                    <div class="tab-nav">
                        <button class="tab-btn active" data-tab="reddit">Reddit API</button>
                        <button class="tab-btn" data-tab="notifications">Notifications</button>
                        <button class="tab-btn" data-tab="detection">Detection</button>
                        <button class="tab-btn" data-tab="schedule">Schedule</button>
                        <button class="tab-btn" data-tab="stock">Stock Monitoring</button>
                    </div>

                    <!-- Reddit Configuration -->
                    <div class="tab-content active" id="reddit-tab">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Reddit API Settings</h2>
                                <p class="card-subtitle">Configure Reddit API access and monitoring parameters</p>
                            </div>

                            <form id="reddit-form">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label>Client ID</label>
                                        <input type="text" id="reddit-client-id" placeholder="Your Reddit App Client ID" required>
                                        <small>Get this from https://www.reddit.com/prefs/apps</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Client Secret</label>
                                        <input type="password" id="reddit-client-secret" placeholder="Your Reddit App Client Secret" required>
                                        <small>Keep this secret and secure</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Subreddit</label>
                                        <input type="text" id="reddit-subreddit" value="MontagneParfums">
                                        <small>Subreddit to monitor (without r/)</small>
                                    </div>

                                    <div class="form-group">
                                        <label>Check Interval (seconds)</label>
                                        <input type="number" id="reddit-interval" value="300" min="60" max="3600">
                                        <small>How often to check for new posts (60-3600 seconds)</small>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="button" class="btn secondary" onclick="testRedditConnection()">Test Connection</button>
                                    <button type="submit" class="btn primary">Save Reddit Settings</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Other tabs content would be here... -->
                </div>
            </div>

        </main>
    </div>

    <script src="/static/js/theme-config.js?v=3"></script>
    <script src="/static/js/dashboard-functions.js?v=3"></script>
    <script src="/static/js/toast.js?v=3"></script>
    <script src="/static/js/theme.js?v=3"></script>
    <script src="/static/js/router.js?v=5"></script>
    <script src="/static/js/app.js?v=3"></script>
    <script src="/static/js/dashboard.js?v=5"></script>
    <script src="/static/js/configuration.js?v=3"></script>
    <script src="/static/js/inventory.js?v=5"></script>
</body>
</html>
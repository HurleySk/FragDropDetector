{% extends "base.html" %}

{% block title %}Dashboard - FragDropDetector{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/dashboard.css">
{% endblock %}

{% block content %}
<div class="dashboard-page" id="dashboard-content">
    <div class="page-header">
        <h1 class="page-title">System Dashboard</h1>
        <p class="page-subtitle">Real-time monitoring overview and system status</p>
    </div>

    <!-- Status Overview -->
    <div class="status-overview grid grid-4">
        <div class="status-card card">
            <div class="status-card-content">
                <div class="status-value" id="drops-count">0</div>
                <div class="status-label">Drops Detected</div>
                <div class="status-trend" id="drops-trend"></div>
            </div>
            <div class="status-icon drops-icon">üéØ</div>
        </div>

        <div class="status-card card">
            <div class="status-card-content">
                <div class="status-value" id="fragrances-count">0</div>
                <div class="status-label">Fragrances Tracked</div>
                <div class="status-trend" id="fragrances-trend"></div>
            </div>
            <div class="status-icon fragrances-icon">üß¥</div>
        </div>

        <div class="status-card card">
            <div class="status-card-content">
                <div class="status-value" id="stock-changes-count">0</div>
                <div class="status-label">Stock Changes</div>
                <div class="status-trend" id="stock-trend"></div>
            </div>
            <div class="status-icon stock-icon">üìà</div>
        </div>

        <div class="status-card card">
            <div class="status-card-content">
                <div class="status-value" id="next-window">--</div>
                <div class="status-label">Next Window</div>
                <div class="status-trend window-active" id="window-status">Active</div>
            </div>
            <div class="status-icon window-icon">‚è∞</div>
        </div>
    </div>

    <!-- System Health -->
    <div class="grid grid-2">
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">System Health</h2>
                <p class="card-subtitle">Current system status and services</p>
            </div>

            <div class="health-grid">
                <div class="health-item">
                    <div class="health-indicator" id="reddit-health"></div>
                    <div class="health-info">
                        <div class="health-name">Reddit API</div>
                        <div class="health-status" id="reddit-status">Checking...</div>
                    </div>
                </div>

                <div class="health-item">
                    <div class="health-indicator" id="database-health"></div>
                    <div class="health-info">
                        <div class="health-name">Database</div>
                        <div class="health-status" id="database-status">Checking...</div>
                    </div>
                </div>

                <div class="health-item">
                    <div class="health-indicator" id="notifications-health"></div>
                    <div class="health-info">
                        <div class="health-name">Notifications</div>
                        <div class="health-status" id="notifications-status">Checking...</div>
                    </div>
                </div>

                <div class="health-item">
                    <div class="health-indicator" id="monitoring-health"></div>
                    <div class="health-info">
                        <div class="health-name">Stock Monitor</div>
                        <div class="health-status" id="monitoring-status">Checking...</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Notification Services</h2>
                <p class="card-subtitle">Active notification channels</p>
            </div>

            <div class="notification-services">
                <div class="service-item" id="pushover-service">
                    <div class="service-icon">üì±</div>
                    <div class="service-info">
                        <div class="service-name">Pushover</div>
                        <div class="service-status">Disabled</div>
                    </div>
                    <button class="test-btn" onclick="testService('pushover')">Test</button>
                </div>

                <div class="service-item" id="discord-service">
                    <div class="service-icon">üí¨</div>
                    <div class="service-info">
                        <div class="service-name">Discord</div>
                        <div class="service-status">Disabled</div>
                    </div>
                    <button class="test-btn" onclick="testService('discord')">Test</button>
                </div>

                <div class="service-item" id="email-service">
                    <div class="service-icon">‚úâÔ∏è</div>
                    <div class="service-info">
                        <div class="service-name">Email</div>
                        <div class="service-status">Disabled</div>
                    </div>
                    <button class="test-btn" onclick="testService('email')">Test</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Quick Actions</h2>
            <p class="card-subtitle">Common tasks and controls</p>
        </div>

        <div class="quick-actions">
            <button class="action-btn primary" onclick="refreshStatus()">
                <span class="btn-icon">üîÑ</span>
                Refresh Status
            </button>

            <button class="action-btn secondary" onclick="testAllNotifications()">
                <span class="btn-icon">üì¢</span>
                Test All Notifications
            </button>

            <button class="action-btn secondary" onclick="navigateToPage('configuration')">
                <span class="btn-icon">‚öôÔ∏è</span>
                Open Settings
            </button>

            <button class="action-btn secondary" onclick="navigateToPage('monitoring')">
                <span class="btn-icon">üìä</span>
                View Data
            </button>
        </div>
    </div>

    <!-- Recent Activity (Preview) -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Recent Activity</h2>
            <p class="card-subtitle">Latest drops and stock changes</p>
        </div>

        <div class="recent-activity">
            <div class="activity-list" id="recent-activity-list">
                <div class="activity-placeholder">
                    Loading recent activity...
                </div>
            </div>

            <div class="activity-footer">
                <button class="view-all-btn" onclick="navigateToPage('monitoring')">
                    View All Activity ‚Üí
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/dashboard.js"></script>
{% endblock %}